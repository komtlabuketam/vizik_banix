{"id": 1, "style": "Magical", "contentVariable": "#define time iTime\n#define TAU (2. * acos(-1.))\n#define beat (time * 114. / 60.)\n#define VOL 0.\n#define SOL 1.\n#define beatTau (beat * TAU)", "contentFunction": "mediump float fft(mediump float d) {\n    return texture2D(iChannel0, vec2(fract(d), 0)).r * 0.4;\n}\n\nmediump float ffts(mediump float d) {\n    return texture2D(iChannel0, vec2(fract(d), 1)).r * 0.4;\n}\n\nmediump float sdBox(mediump vec3 p, mediump vec3 b) {\n    mediump vec3 q = abs(p) - b;\n    return length(max(q, vec3(0))) + min(0., max(q.x, max(q.y, q.z)));\n}\n\nvoid U(inout mediump vec4 m, mediump float d, mediump float a, mediump float b, mediump float c) {\n    if (d < m.x) m = vec4(d, a, b, c);\n}\n\nmediump vec3 pal(mediump float a) {\n    return vec3(0.5) + vec3(0.5) * cos(TAU * (a + vec3(0, 1, 2) / 3.));\n}\n\nvoid rot(inout mediump vec2 p, mediump float a) {\n    p *= mat2(cos(a), sin(a), sin(-a), cos(a));\n}\n\nmediump vec4 map(mediump vec3 p) {\n    mediump vec4 m = vec4(1, VOL, 0, 0);\n    mediump vec3 pos = p;\n    mediump vec3 id = abs(pos);\n\n    mediump float a = 1. + 5. * ffts(0.01);\n    p = mod(p, a) - 0.5 * a;\n\n    mediump float b = 1.4;\n    mediump float s = 1.;\n\n    for (mediump int i = 0; i < 5; i++) {\n        p = abs(p) - 0.5;\n        rot(p.xz, -0.5);\n        p = abs(p) - 0.4;\n        rot(p.zy, -0.2);\n\n        s *= b;\n        p *= b;\n    }\n\n    mediump float d = pow(fract(id.x * 5.), 0.5);\n\n    U(m, sdBox(p, vec3(2, 0.1, 0.1)) / s, SOL, 1., pos.x * 10.);\n    U(m, sdBox(p, vec3(2, 0.2, 0.1)) / s, VOL, 10. * fft(d), d);\n    U(m, sdBox(p, vec3(0.3, 5, 0.1)) / s, VOL, 50. * fft(d), d);\n\n    return m;\n}", "contentVisualizer": "uv = vec2(gl_FragCoord.x / iResolution.x, gl_FragCoord.y / iResolution.y);\n    uv -= 0.5;\n    uv /= vec2(iResolution.y / iResolution.x, 1);\n\n    mediump vec3 col = vec3(0);\n\n    mediump vec3 ro = vec3(0, 0, time);\n    mediump vec3 ray = vec3(uv, 1);\n    rot(ray.xy, TAU * 2.313 * floor(beat));\n    ray = normalize(ray);\n\n    mediump float t = 0.;\n    for (mediump int i = 0; i < 50; i++) {\n        mediump vec3 p = ro + ray * t;\n        mediump vec4 m = map(p);\n        mediump float d = m.x;\n\n        if (m.y == SOL) {\n            t += d;\n            if (d < 0.01) {\n                col += 0.01 * float(i);\n                break;\n            }\n        } else {\n            t += abs(d) * 0.5 + 0.01;\n            col += clamp(0.0002 * pal(m.w) * m.z / abs(d), 0., 1.);\n        }\n    }\n\n    mediump vec2 uv2 = clamp((abs(uv)),0., 1.);\n\n    mediump float wave = fft(uv2.x * 1.) - uv2.y;\n\n    col = mix(vec3(0), col, exp(-1. * t));\n\n    mediump float b = mod(beat, 4.);\n\n    if (b < 1.) {\n        col += 5. * wave;\n    } else if (b < 2.) {\n        col += -100. * wave;\n    } else if (b < 3.) {\n        rot(uv, TAU * exp(-8. * mod(beat, 1.)) / 4.);\n        mediump float d = abs(uv.x) + abs(uv.y);\n\n        d = mod(d * 4., 0.5);\n\n        mediump float th = exp(-4. * mod(beat, 1.));\n\n        if (d < th - 0.1 && d < th) {\n            col += -100. * wave;\n        } else {\n            col += 5. * wave;\n        }\n    } else {\n        col += 10. * wave;\n    }\n    visualizer = col;"}